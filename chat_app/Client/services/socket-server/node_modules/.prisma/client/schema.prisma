generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  email    String @unique
  name     String
  password String

  @@map("users")
}

model Message {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  senderId   String
  senderName String
  receiverId String
  text       String
  timestamp  DateTime @default(now())
  read       Boolean  @default(false)

  @@index([senderId, receiverId, timestamp])
  @@map("messages")
}

model OnlineUser {
  id       String   @id @default(auto()) @map("_id") @db.ObjectId
  userId   String   @unique
  userName String
  socketId String?
  lastSeen DateTime @default(now())
  isOnline Boolean  @default(false)

  @@map("online_users")
}

model FriendRequest {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  senderId     String
  senderName   String
  receiverId   String
  receiverName String
  status       String   @default("pending") // pending, accepted, rejected
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([senderId, receiverId])
  @@index([receiverId, status])
  @@map("friend_requests")
}

model Friendship {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  userId     String
  userName   String
  friendId   String
  friendName String
  createdAt  DateTime @default(now())

  @@index([userId])
  @@index([friendId])
  @@map("friendships")
}
